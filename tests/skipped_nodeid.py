def list_nvidia_v3_1():
    UNSELECT_NODEIDS = {
        "tests/test_attention_ops.py::test_sdpa_nonsquare_qk[dtype0-False-64-1-1-128-2048]",
        "tests/test_attention_ops.py::test_flash_fwd_nonsquare_qk[dtype0-False-64-1-1-128-2048]",
        "tests/test_attention_ops.py::test_flash_splitkv[dtype0-False-None-False-128-1-4-1-1-1024]",
        "tests/test_attention_ops.py::test_flash_mla[dtype0-1024]",
        "tests/test_binary_pointwise_ops.py::test_accuracy_trunc_div[dtype0-shape0]",
        "tests/test_binary_pointwise_ops.py::test_accuracy_trunc_div_[dtype0-shape0]",
        "tests/test_binary_pointwise_ops.py::test_accuracy_floor_divide_float[dtype0-shape0]",
        "tests/test_binary_pointwise_ops.py::test_accuracy_floor_divide_float_[dtype0-shape0]",
        "tests/test_binary_pointwise_ops.py::test_accuracy_gelu_and_mul[none-dtype0-shape0]",
        "tests/test_binary_pointwise_ops.py::test_accuracy_pow[dtype0-shape0]",
        "tests/test_binary_pointwise_ops.py::test_accuracy_pow_[dtype0-shape0]",
        "tests/test_reduction_ops.py::test_accuracy_amax[dtype0-True-1-shape0]",
        "tests/test_binary_pointwise_ops.py::test_accuracy_pow_scalar_tensor[dtype0-shape0-0.001]",
        "tests/test_binary_pointwise_ops.py::test_accuracy_pow_tensor_scalar[dtype0-0.001-shape0]",
        "tests/test_binary_pointwise_ops.py::test_accuracy_pow_tensor_scalar_[dtype0-0.001-shape0]",
        "tests/test_binary_pointwise_ops.py::test_accuracy_nan_to_num[None-None-None-dtype0-shape0]",
        "tests/test_binary_pointwise_ops.py::test_accuracy_isclose[0-False-False-dtype0-shape0]",
        "tests/test_blas_ops.py::test_accuracy_mm[True-dtype0-1-1-32]",
        "tests/test_convolution_ops.py::test_accuracy_conv3d[True-1-dtype0-0-1-shape0-kernel0-1]",
        "tests/test_general_reduction_ops.py::test_accuracy_allclose[0-False-dtype0-shape0]",
        "tests/test_norm_ops.py::test_accuracy_groupnorm[dtype0-False-16-3-16-16-1]",
        "tests/test_norm_ops.py::test_accuracy_batch_norm[True-dtype0-shape0]",
        "tests/test_pointwise_type_promotion.py::test_type_promotion_bool_to_long[float_dtype0-shape0]",
        "tests/test_distribution_ops.py::test_accuracy_normal[dtype0-shape0-none]",
        "tests/test_distribution_ops.py::test_accuracy_uniform[dtype0-shape0]",
        "tests/test_distribution_ops.py::test_accuracy_exponential_[dtype0-shape0]",
        "tests/test_distribution_ops.py::test_accuracy_multinomial_with_replacement[2048-dtype0-shape0]",
        "tests/test_reduction_ops.py::test_accuracy_scatter_mul[dtype0-0-inp_shape0-src_shape0]",
        "tests/test_reduction_ops.py::test_accuracy_inplace_scatter_mul[dtype0-0-inp_shape0-src_shape0]",
        "tests/test_special_ops.py::test_upsample_nearest2d[dtype0-shape0-scale0]",
        "tests/test_special_ops.py::test_accuracy_vstack[dtype0-shape0]",
        "tests/test_special_ops.py::test_upsample_nearest2d[dtype0-shape0-scale0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_angle[dtype0-shape0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_gelu[none-dtype0-shape0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_gelu_backward[none-dtype0-shape0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_gelu_[none-dtype0-shape0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_glu[dtype0-shape0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_glu_backward[dtype0-shape0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_isinf[dtype0-shape0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_isnan[dtype0-shape0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_sigmoid[dtype0-shape0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_sigmoid_[dtype0-shape0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_silu_backward[dtype0-shape0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_tanh[dtype0-shape0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_tanh_[dtype0-shape0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_triu[dtype0-shape0--2]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_isfinite[dtype0-shape0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_atan[dtype0-shape0]",
        "tests/test_reduction_ops.py::test_topk_softmax[1-4-2-index_dtype0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_atan_[dtype0-shape0]",
    }
    UNSELECT_FUNCTION_NAMES = {
        "test_topk",
        "test_topk_softmax",
        "test_accuracy_amax",
        "test_upsample_nearest2d",
        "test_accuracy_normal",
        "test_accuracy_dropout",
        "test_accuracy_dropout_backward",
        "test_apply_rotary_pos_emb",
        "test_embedding",
        "test_embedding_backward",
        "test_accuracy_resolve_neg",
        "test_topk",
        "test_accuracy_resolve_conj",
        "test_accuracy_unique",
        "test_accuracy_multinomial_with_replacement",
        "test_accuracy_multinomial_without_replacement",
        "test_pad",
        "test_upsample_bicubic2d_aa",
        "test_upsample_nearest2d",
        "test_arange",
        "test_linspace",
        "test_logspace",
        "test_accuracy_isin",
        "test_fill",
        "test_accuracy_stack",
        "test_accuracy_hstack",
        "test_exception_hstack",
        "test_accuracy_cat",
        "test_accuracy_cat_empty_tensor",
        "test_accuracy_vstack",
        "test_accuracy_repeat_interleave_self_int",
        "test_accuracy_repeat_interleave_self_int_non_contiguous",
        "test_accuracy_repeat_interleave_tensor",
        "test_accuracy_repeat_interleave_self_tensor",
        "test_accuracy_diag",
        "test_accuracy_diag_embed",
        "test_accuracy_diagonal_backward",
        "test_sort",
        "test_accuracy_kron",
        "test_accuracy_contiguous",
        "test_accuracy_rwkv_kafusion",
        "test_accuracy_rwkv_mmsparsity",
        "test_accuracy_all_without_dim",
        "test_accuracy_all_dims",
        "test_accuracy_allclose",
        "test_accuracy_any_without_dim",
        "test_accuracy_any_dims",
        "test_accuracy_max_without_dim",
        "test_accuracy_max_without_dim_all_neg_inf",
        "test_accuracy_max_int",
        "test_accuracy_max_without_dim_uncontiguous",
        "test_accuracy_max_dim",
        "test_accuracy_max_dim_big_shape",
        "test_accuracy_mean_without_dim",
        "test_accuracy_mean_dim",
        "test_accuracy_min_without_dim",
        "test_accuracy_min_without_dim_all_inf",
        "test_accuracy_min_dim",
        "test_accuracy_prod_without_dim",
        "test_accuracy_prod_dim",
        "test_accuracy_sum_without_dim",
        "test_accuracy_sum_dim",
        "test_accuracy_quantile_without_dim",
        "test_accuracy_quantile_dim",
        "test_accuracy_conv3d",
        "test_accuracy_conv3_1d",
        "test_accuracy_conv2d",
        "test_accuracy_depthwise2d",
        "test_accuracy_gelu",
        "test_accuracy_gelu_",
        "test_accuracy_silu_backward",
        "test_accuracy_triu",
        "test_accuracy_scatter_mul",
        "test_accuracy_inplace_scatter_mul",
        "test_accuracy_mm",
        "test_type_promotion_bool_to_long",
    }
    return UNSELECT_NODEIDS, UNSELECT_FUNCTION_NAMES
def list_hcu_v3_1():
    UNSELECT_NODEIDS = {
        "tests/test_attention_ops.py::test_sdpa_nonsquare_qk[dtype0-False-64-1-1-128-2048]",
        "tests/test_attention_ops.py::test_flash_fwd_nonsquare_qk[dtype0-False-64-1-1-128-2048]",
        "tests/test_attention_ops.py::test_flash_splitkv[dtype0-False-None-False-128-1-4-1-1-1024]",
        "tests/test_attention_ops.py::test_flash_mla[dtype0-1024]",
        "tests/test_binary_pointwise_ops.py::test_accuracy_trunc_div[dtype0-shape0]",
        "tests/test_binary_pointwise_ops.py::test_accuracy_trunc_div_[dtype0-shape0]",
        "tests/test_binary_pointwise_ops.py::test_accuracy_floor_divide_float[dtype0-shape0]",
        "tests/test_binary_pointwise_ops.py::test_accuracy_floor_divide_float_[dtype0-shape0]",
        "tests/test_binary_pointwise_ops.py::test_accuracy_gelu_and_mul[none-dtype0-shape0]",
        "tests/test_binary_pointwise_ops.py::test_accuracy_pow[dtype0-shape0]",
        "tests/test_binary_pointwise_ops.py::test_accuracy_pow_[dtype0-shape0]",
        "tests/test_reduction_ops.py::test_accuracy_amax[dtype0-True-1-shape0]",
        "tests/test_binary_pointwise_ops.py::test_accuracy_pow_scalar_tensor[dtype0-shape0-0.001]",
        "tests/test_binary_pointwise_ops.py::test_accuracy_pow_tensor_scalar[dtype0-0.001-shape0]",
        "tests/test_binary_pointwise_ops.py::test_accuracy_pow_tensor_scalar_[dtype0-0.001-shape0]",
        "tests/test_binary_pointwise_ops.py::test_accuracy_nan_to_num[None-None-None-dtype0-shape0]",
        "tests/test_binary_pointwise_ops.py::test_accuracy_isclose[0-False-False-dtype0-shape0]",
        "tests/test_blas_ops.py::test_accuracy_mm[True-dtype0-1-1-32]",
        "tests/test_convolution_ops.py::test_accuracy_conv3d[True-1-dtype0-0-1-shape0-kernel0-1]",
        "tests/test_general_reduction_ops.py::test_accuracy_allclose[0-False-dtype0-shape0]",
        "tests/test_norm_ops.py::test_accuracy_groupnorm[dtype0-False-16-3-16-16-1]",
        "tests/test_norm_ops.py::test_accuracy_batch_norm[True-dtype0-shape0]",
        "tests/test_pointwise_type_promotion.py::test_type_promotion_bool_to_long[float_dtype0-shape0]",
        "tests/test_distribution_ops.py::test_accuracy_normal[dtype0-shape0-none]",
        "tests/test_distribution_ops.py::test_accuracy_uniform[dtype0-shape0]",
        "tests/test_distribution_ops.py::test_accuracy_exponential_[dtype0-shape0]",
        "tests/test_distribution_ops.py::test_accuracy_multinomial_with_replacement[2048-dtype0-shape0]",
        "tests/test_reduction_ops.py::test_accuracy_scatter_mul[dtype0-0-inp_shape0-src_shape0]",
        "tests/test_reduction_ops.py::test_accuracy_inplace_scatter_mul[dtype0-0-inp_shape0-src_shape0]",
        "tests/test_special_ops.py::test_upsample_nearest2d[dtype0-shape0-scale0]",
        "tests/test_special_ops.py::test_accuracy_vstack[dtype0-shape0]",
        "tests/test_special_ops.py::test_upsample_nearest2d[dtype0-shape0-scale0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_angle[dtype0-shape0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_gelu[none-dtype0-shape0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_gelu_backward[none-dtype0-shape0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_gelu_[none-dtype0-shape0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_glu[dtype0-shape0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_glu_backward[dtype0-shape0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_isinf[dtype0-shape0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_isnan[dtype0-shape0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_sigmoid[dtype0-shape0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_sigmoid_[dtype0-shape0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_silu_backward[dtype0-shape0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_tanh[dtype0-shape0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_tanh_[dtype0-shape0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_triu[dtype0-shape0--2]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_isfinite[dtype0-shape0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_atan[dtype0-shape0]",
        "tests/test_reduction_ops.py::test_topk_softmax[1-4-2-index_dtype0]",
        "tests/test_unary_pointwise_ops.py::test_accuracy_atan_[dtype0-shape0]",
    }
    UNSELECT_FUNCTION_NAMES = {
        "test_topk",
        "test_topk_softmax",
        "test_accuracy_amax",
        "test_upsample_nearest2d",
        "test_accuracy_normal",
        "test_accuracy_dropout",
        "test_accuracy_dropout_backward",
        "test_apply_rotary_pos_emb",
        "test_embedding",
        "test_embedding_backward",
        "test_accuracy_resolve_neg",
        "test_topk",
        "test_accuracy_resolve_conj",
        "test_accuracy_unique",
        "test_accuracy_multinomial_with_replacement",
        "test_accuracy_multinomial_without_replacement",
        "test_pad",
        "test_upsample_bicubic2d_aa",
        "test_upsample_nearest2d",
        "test_arange",
        "test_linspace",
        "test_logspace",
        "test_accuracy_isin",
        "test_fill",
        "test_accuracy_stack",
        "test_accuracy_hstack",
        "test_exception_hstack",
        "test_accuracy_cat",
        "test_accuracy_cat_empty_tensor",
        "test_accuracy_vstack",
        "test_accuracy_repeat_interleave_self_int",
        "test_accuracy_repeat_interleave_self_int_non_contiguous",
        "test_accuracy_repeat_interleave_tensor",
        "test_accuracy_repeat_interleave_self_tensor",
        "test_accuracy_diag",
        "test_accuracy_diag_embed",
        "test_accuracy_diagonal_backward",
        "test_sort",
        "test_accuracy_kron",
        "test_accuracy_contiguous",
        "test_accuracy_rwkv_kafusion",
        "test_accuracy_rwkv_mmsparsity",
        "test_accuracy_all_without_dim",
        "test_accuracy_all_dims",
        "test_accuracy_allclose",
        "test_accuracy_any_without_dim",
        "test_accuracy_any_dims",
        "test_accuracy_max_without_dim",
        "test_accuracy_max_without_dim_all_neg_inf",
        "test_accuracy_max_int",
        "test_accuracy_max_without_dim_uncontiguous",
        "test_accuracy_max_dim",
        "test_accuracy_max_dim_big_shape",
        "test_accuracy_mean_without_dim",
        "test_accuracy_mean_dim",
        "test_accuracy_min_without_dim",
        "test_accuracy_min_without_dim_all_inf",
        "test_accuracy_min_dim",
        "test_accuracy_prod_without_dim",
        "test_accuracy_prod_dim",
        "test_accuracy_sum_without_dim",
        "test_accuracy_sum_dim",
        "test_accuracy_quantile_without_dim",
        "test_accuracy_quantile_dim",
        "test_accuracy_conv3d",
        "test_accuracy_conv3_1d",
        "test_accuracy_conv2d",
        "test_accuracy_depthwise2d",
        "test_accuracy_gelu",
        "test_accuracy_gelu_",
        "test_accuracy_silu_backward",
        "test_accuracy_triu",
        "test_accuracy_scatter_mul",
        "test_accuracy_inplace_scatter_mul",
        "test_accuracy_mm",
        "test_type_promotion_bool_to_long",
    }
    return UNSELECT_NODEIDS, UNSELECT_FUNCTION_NAMES

def list_iluvatar_v3_1():
    UNSELECT_FUNCTION_NAMES = {
        "test_decorator_cascade",
        "test_pass_kernel_arg_via_kw",
        "test_kernel_arg_apply_default",
        "test_threadsafety",
        "test_hash_generation",
        "test_hash_changes_when_dependency_modified",
        "test_libcache_vllm_signal_scenario",
        "test_libcache_concurrent_write_on_signal",
    }
    UNSELECT_NODEIDS={}
    return UNSELECT_NODEIDS, UNSELECT_FUNCTION_NAMES

#import flag_gems
import triton
import re
version_name=print(triton.__version__)
device=flag_gems.device
vendor_name=device.vendor_name.lower()
match = re.match(r"(\d+\.\d+\.\d+)\.dev(\d+)", version_name)
main = match.group(1)
dispatch = { "nvidia_3.1.0": list_nvidia_v3_1, 
             "iluvatar_3.1.0": list_iluvatar_v3_1, 
             "hcu_3.1.0": list_hcu_v3_1,
            }
version = f"{vendor_name}_{version_name}" # set your version here
UNSELECT_NODEIDS, UNSELECT_FUNCTION_NAMES = dispatch.get(version, lambda: [])()
